\documentclass{bschlangaul-aufgabe}
\bLadePakete{syntax}
\begin{document}
\bAufgabenMetadaten{
  Titel = {Aufgabe 4},
  Thematik = {Kundenverwaltungssystem},
  Referenz = 46116-2018-H.T1-TA2-A4,
  RelativerPfad = Staatsexamen/46116/2018/09/Thema-1/Teilaufgabe-2/Aufgabe-4.tex,
  ZitatSchluessel = db:pu:1,
  ZitatBeschreibung = {SQL Einstieg, Aufgabe 6},
  BearbeitungsStand = mit Lösung,
  Korrektheit = unbekannt,
  Ueberprueft = {unbekannt},
  Stichwoerter = {CREATE TABLE},
  EinzelpruefungsNr = 46116,
  Jahr = 2018,
  Monat = 09,
  ThemaNr = 1,
  TeilaufgabeNr = 2,
  AufgabeNr = 4,
}

Gegeben sind folgende Relationen aus einem Kundenverwaltungssystem:
\footcite[SQL Einstieg, Aufgabe 6]{db:pu:1}

\begin{minted}{md}
Kunde (ID, Vorname, Nachname, PLZ)
Produkt (GTIN, Bezeichnung, Bruttopreis, MWStSatz)
Kauf (ID[Kunde], GTIN[Produkt], Datum, Menge)
\end{minted}

\begin{enumerate}

%%
% (a)
%%

\item Schreiben Sie eine SQL-Anweisung, die \emph{Vorname} und
\emph{Nachname} aller \emph{Kunden} mit der Postleitzahl \emph{20251}
ausgibt, \emph{absteigend} sortiert nach \emph{Nachname} und bei
gleichen Nachnamen absteigend nach \emph{Vorname}.

ASC (ascending) = aufsteigend
DESC (descending) = absteigend

\begin{bAntwort}
\begin{minted}{sql}
SELECT Vorname, Nachname
FROM Kunde
WHERE PLZ = 20251
ORDER BY Nachname, Vorname DESC;
\end{minted}
\end{bAntwort}

%%
% (b)
%%

\item Schreiben Sie eine SQL-Anweisung, die die Bezeichnung aller
Produkte ausgibt, deren Bruttopreis größer ist als 10 €.

\begin{bAntwort}
\begin{minted}{sql}
SELECT Bezeichnung
FROM Produkt
WHERE Bruttopreis > 10;
\end{minted}
\end{bAntwort}

%%
% (c)
%%

\item Schreiben Sie eine SQL-Anweisung, die die Tabelle „Kauf“ anlegt.
Gehen Sie davon aus, dass die Tabellen „Kunde“ und „Produkt“ bereits
existieren.\index{CREATE TABLE}

\begin{bAntwort}
\begin{minted}{sql}
CREATE TABLE Kauf (
  ID INTEGER REFERENCES Kunde(ID),
  GTIN INTEGER REFERENCES Produkt(GTIN),
  Datum DATE,
  Menge INTEGER,
  PRIMARY KEY (ID, GTIN, Datum)
);
\end{minted}
\end{bAntwort}
\end{enumerate}
\end{document}
